<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar - Arcade Planner</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
<button id="settings-toggle" title="SetÄƒri temÄƒ">
    âš™ï¸
</button>

<div id="settings-popup">
    <button id="close-popup">âœ•</button>
    
    <div id="settings-bar">
        <h3>Modificare TemÄƒ</h3>
        <label for="theme-switch">SelecteazÄƒ Tema:</label>
        <select id="theme-switch">
            <option value="dark">Negru (Implicit)</option>
            <option value="light">Alb</option>
        </select>
    </div>
</div>

    <h1>ğŸ—“ï¸ Calendar Taskuri Arcade</h1>

    <div class="container">
        <p>Aici poÈ›i vedea toate taskurile ordonate dupÄƒ deadline:</p>
        <div id="calendar-view">
            </div>

        <div id="calendar-legend">
            <h2>Cheie Taskuri (Legenda)</h2>
            <div class="legend-item">
                <span class="legend-color task-verificare"></span> Verificare LocaÈ›ie
            </div>
            <div class="legend-item">
                <span class="legend-color task-montare"></span> Montare Echipamente
            </div>
            <div class="legend-item">
                <span class="legend-color task-aranjare"></span> Aranjare FinalÄƒ/EsteticÄƒ
            </div>
        </div>
    </div>

    <script src="arcade-todo.js"></script>

<script>
// ReferinÈ›e la elementele DOM
const themeSwitch = document.getElementById('theme-switch');
const settingsToggle = document.getElementById('settings-toggle');
const settingsPopup = document.getElementById('settings-popup');
const closePopup = document.getElementById('close-popup');
const calendarView = document.getElementById('calendar-view'); // Elementul unde se afiÈ™eazÄƒ calendarul

// FuncÈ›ie pentru aplicarea temei È™i salvarea ei
function applyTheme(theme) {
    document.body.classList.toggle('light', theme === 'light');
    localStorage.setItem('siteTheme', theme);
}

// 4. LOGICA DE GENERARE A CALENDARULUI (MutatÄƒ aici pentru coerenÈ›Äƒ)
function generateCalendar(targetElement) {
    const today = new Date();
    const currentYear = today.getFullYear();
    const currentMonth = today.getMonth(); // 0 = Ianuarie

    // Numele lunii È™i zilelor sÄƒptÄƒmÃ¢nii (Ã®n RomÃ¢nÄƒ)
    const monthNames = ["Ianuarie", "Februarie", "Martie", "Aprilie", "Mai", "Iunie", "Iulie", "August", "Septembrie", "Octombrie", "Noiembrie", "Decembrie"];
    const dayNames = ["Dum", "Lun", "Mar", "Mie", "Joi", "Vin", "SÃ¢m"];

    // Task-urile posibile È™i culorile lor (folosind clase CSS)
    const taskTypes = [
        { name: 'Verificare', className: 'task-verificare' },
        { name: 'Montare', className: 'task-montare' },
        { name: 'Aranjare', className: 'task-aranjare' }
    ];

    // CÃ¢te zile are luna curentÄƒ
    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
    // Ziua din sÄƒptÄƒmÃ¢nÄƒ a primei zile (0=DuminicÄƒ, 1=Luni...)
    const firstDayOfWeek = new Date(currentYear, currentMonth, 1).getDay();
    
    let calendarHTML = `<h2>${monthNames[currentMonth]} ${currentYear}</h2>`;
    calendarHTML += `<div class="calendar-grid">`;

    // Capetele de tabel cu zilele sÄƒptÄƒmÃ¢nii
    dayNames.forEach(day => {
        calendarHTML += `<div class="day-header">${day}</div>`;
    });

    // Celule goale pentru zilele din luna anterioarÄƒ
    for (let i = 0; i < firstDayOfWeek; i++) {
        calendarHTML += `<div class="calendar-day empty"></div>`;
    }

    // Celulele cu datele lunii curente
    for (let day = 1; day <= daysInMonth; day++) {
        let dayClass = '';
        let taskInfo = '';
        
        // GenereazÄƒ aleatoriu task-uri (aproximativ 40% È™anse sÄƒ aibÄƒ un task)
        if (Math.random() < 0.4) { 
            const randomTaskIndex = Math.floor(Math.random() * taskTypes.length);
            const task = taskTypes[randomTaskIndex];

            dayClass = task.className; // AdaugÄƒ clasa de culoare
            taskInfo = `<span class="task-label">${task.name}</span>`;
        }

        // MarcheazÄƒ ziua de azi
        const isToday = (day === today.getDate() && currentMonth === today.getMonth() && currentYear === today.getFullYear()) ? 'today' : '';

        calendarHTML += `<div class="calendar-day ${isToday} ${dayClass}">
                            <span class="day-number">${day}</span>
                            ${taskInfo}
                         </div>`;
    }
    
    calendarHTML += `</div>`; // Ãnchide calendar-grid
    targetElement.innerHTML = calendarHTML;
}

// 1. ÃNCARCÄ‚ TEMA LA STARTUP
document.addEventListener('DOMContentLoaded', () => {
    const savedTheme = localStorage.getItem('siteTheme') || 'dark';
    applyTheme(savedTheme);
    
    // SeteazÄƒ valoarea selectului, dacÄƒ elementul themeSwitch existÄƒ.
    if (themeSwitch) {
        themeSwitch.value = savedTheme; 
    }
    
    // GENEREAZÄ‚ CALENDARUL la Ã®ncÄƒrcarea paginii
    if (calendarView) {
        generateCalendar(calendarView);
    }
});

// 2. SCHIMBÄ‚ TEMA
if (themeSwitch) {
    themeSwitch.addEventListener('change', () => {
        const theme = themeSwitch.value;
        applyTheme(theme);
    });
}

// 3. LOGICA POP-UP
if (settingsToggle) {
    settingsToggle.addEventListener('click', () => {
        if (settingsPopup) {
            settingsPopup.classList.toggle('open');
        }
    });
}

if (closePopup) {
    closePopup.addEventListener('click', () => {
        if (settingsPopup) {
            settingsPopup.classList.remove('open');
        }
    });
}

// Ãnchide pop-up-ul cÃ¢nd se apasÄƒ tasta ESC
document.addEventListener('keydown', (event) => {
    if (event.key === 'Escape' && settingsPopup && settingsPopup.classList.contains('open')) {
        settingsPopup.classList.remove('open');
    }
});
</script>

</body>
</html>